<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AudioNews - Daily Voice News Digest</title>
    <meta name="description" content="Daily AI-generated audio news digest. Professional voice, screen reader optimized, available in multiple languages.">
    <meta name="keywords" content="audio news, voice news, daily news digest, accessible news, multilingual news, UK news, French news, German news, blind, partially sighted, blind and partially sighted, visually impaired, screen reader, accessible news for blind">
    
    <!-- SEO Meta Tags -->
    <meta name="author" content="Dynamic Devices">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://audionews.uk/">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://audionews.uk/">
    <meta property="og:title" content="AudioNews - Daily Voice News Digest">
    <meta property="og:description" content="Daily AI-generated audio news digest in multiple languages">
    <meta property="og:image" content="https://audionews.uk/shared/images/social-card.png">
    <meta property="og:site_name" content="AudioNews">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://audionews.uk/">
    <meta property="twitter:title" content="AudioNews - Daily Voice News Digest">
    <meta property="twitter:description" content="Daily AI-generated audio news digest in multiple languages">
    <meta property="twitter:image" content="https://audionews.uk/shared/images/social-card.png">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a365d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="AudioNews">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüì∞%3C/text%3E%3C/svg%3E">
    
    <!-- Critical CSS -->
    <style>
        /* Critical styles for immediate rendering */
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: #f8fafc;
            color: #2d3748;
        }
        
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: #1a365d;
            color: white;
            padding: 8px;
            text-decoration: none;
            z-index: 1000;
            border-radius: 0 0 4px 4px;
        }
        
        .skip-link:focus {
            top: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .tagline {
            margin: 0.5rem 0 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .language-selector {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .lang-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .lang-btn:hover, .lang-btn.active {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.6);
            transform: translateY(-2px);
        }
        
        .lang-btn.active {
            background: rgba(255, 255, 255, 0.4);
            font-weight: 600;
        }
        
        .lang-btn.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            pointer-events: none;
            text-decoration: line-through;
        }
        
        .lang-btn.disabled:hover {
            transform: none;
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Loading state */
        .loading {
            text-align: center;
            padding: 3rem;
            color: #718096;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-radius: 50%;
            border-top-color: #3182ce;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Help section styling */
        .digest-help {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .help-item {
            margin-bottom: 1.25rem;
        }
        
        .help-item:last-child {
            margin-bottom: 0;
        }
        
        .help-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
            font-weight: 600;
            color: #1a365d;
        }
        
        .help-icon {
            font-size: 1.1rem;
        }
        
        .help-description {
            margin: 0;
            color: #4a5568;
            line-height: 1.5;
            font-size: 0.95rem;
        }
        
        /* Coming Soon styling - Clean and Professional */
        .coming-soon-message {
            text-align: center;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border-radius: 16px;
            margin: 1.5rem 0;
            box-shadow: 0 20px 40px rgba(79, 70, 229, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .coming-soon-message::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white" opacity="0.1"/><circle cx="75" cy="75" r="1" fill="white" opacity="0.1"/><circle cx="50" cy="10" r="0.5" fill="white" opacity="0.1"/><circle cx="10" cy="60" r="0.5" fill="white" opacity="0.1"/><circle cx="90" cy="40" r="0.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }
        
        .status-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            animation: float 3s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }
        
        .coming-soon-message h4 {
            margin: 0 0 1.5rem 0;
            font-size: 1.75rem;
            font-weight: 700;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .coming-soon-message p {
            margin: 0.75rem 0;
            opacity: 0.95;
            line-height: 1.7;
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .refresh-actions {
            margin-top: 2.5rem;
            position: relative;
            z-index: 1;
        }
        
        .refresh-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.25);
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
            backdrop-filter: blur(10px);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .refresh-btn:active {
            transform: translateY(-1px);
        }
        
        /* Content area */
        .content {
            min-height: 60vh;
            padding: 2rem 0;
        }
        
        /* Hide content initially */
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }
    
        .lang-link.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            pointer-events: none;
            text-decoration: line-through;
        }
        
        .lang-link.disabled:hover {
            transform: none;
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
    
    <!-- Load full CSS asynchronously -->
    <link rel="preload" href="shared/css/newspaper.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="shared/css/newspaper.css"></noscript>
</head>
<body>
    <!-- Skip to main content link for screen readers -->
    <a href="#main-content" class="skip-link" data-i18n="skip_link">Skip to main content</a>
    
    <!-- Header -->
    <header class="site-header" role="banner">
        <div class="header-container" style="text-align: center;">
            <h1 class="site-title">
                <span class="site-icon" aria-hidden="true" id="site-flag">üì∞</span>
                <span id="site-name">AudioNews</span>
            </h1>
            <p class="site-tagline" id="site-tagline">Brought to you by Dynamic Devices</p>
            
                    <!-- Language Selector -->
                    <div class="language-selector" role="navigation" aria-label="Language selection">
                        <button class="lang-btn active" data-lang="en_GB" aria-label="English (UK)">
                            üá¨üáß English
                        </button>
                        <button class="lang-btn disabled" data-lang="fr_FR" aria-label="Fran√ßais (France) - Coming Soon">
                            üá´üá∑ Fran√ßais <small>(Coming Soon)</small>
                        </button>
                        <button class="lang-btn disabled" data-lang="de_DE" aria-label="Deutsch (Deutschland) - Coming Soon">
                            üá©üá™ Deutsch <small>(Coming Soon)</small>
                        </button>
                        <button class="lang-btn disabled" data-lang="es_ES" aria-label="Espa√±ol (Espa√±a) - Coming Soon">
                            üá™üá∏ Espa√±ol <small>(Coming Soon)</small>
                        </button>
                        <button class="lang-btn disabled" data-lang="it_IT" aria-label="Italiano (Italia) - Coming Soon">
                            üáÆüáπ Italiano <small>(Coming Soon)</small>
                        </button>
                        <button class="lang-btn disabled" data-lang="nl_NL" aria-label="Nederlands (Nederland) - Coming Soon">
                            üá≥üá± Nederlands <small>(Coming Soon)</small>
                        </button>
                        <button class="lang-btn disabled" data-lang="pl_PL" aria-label="Polski (Polska) - Coming Soon">
                            üáµüá± Polski <small>(Coming Soon)</small>
                        </button>
                        <button class="lang-btn" data-lang="bella" aria-label="BellaNews - Business & Finance">
                            üìä BellaNews
                        </button>
                    </div>
        </div>
    </header>

    <!-- Main content area -->
    <main id="main-content" class="main-content" role="main">
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <p data-i18n="loading">Loading your personalized news digest...</p>
        </div>
        
        <!-- Content will be dynamically loaded here -->
        <div id="content-container"></div>
    </main>

    <!-- Footer -->
    <footer class="site-footer" role="contentinfo">
        <div class="footer-container" style="text-align: center;">
            <p class="copyright" id="footer-text">
                ¬© 2025 Dynamic Devices ‚Ä¢ 
                <a href="https://github.com/DynamicDevices/daily-voice-news" class="footer-link">Open Source on GitHub</a> ‚Ä¢ 
                Made with ‚ôø accessibility in mind
            </p>
        </div>
    </footer>
    
    <!-- JavaScript -->
    <script src="shared/js/accessibility.js" defer></script>
    
    <!-- Multi-language App Logic -->
    <script>
        class AudioNewsApp {
            constructor() {
                this.currentLanguage = 'en_GB';
                this.languages = {};
                this.contentCache = {};
                this.supportedLanguages = ['en_GB', 'fr_FR', 'de_DE', 'es_ES', 'it_IT', 'nl_NL', 'en_GB_LON', 'en_GB_LIV'];
                this.init();
            }
            
            async init() {
                // Load language configurations first
                await this.loadLanguageConfigs();
                
                // Detect user's preferred language
                await this.detectLanguage();
                
                // Set up event listeners
                this.setupEventListeners();
                
                // Load initial content
                await this.loadContent(this.currentLanguage);
            }
            
            async detectLanguage() {
                try {
                    // TEMPORARY: Force all users to en_GB (other languages disabled)
                    console.log('Redirecting to en_GB - other languages temporarily disabled');
                    window.location.href = '/en_GB/';
                        return;
                } catch (e) {
                    console.log('Language detection failed, using default');
                }
            }
            
            async loadLanguageConfigs() {
                console.log('Loading language configurations...');
                for (const lang of this.supportedLanguages) {
                    try {
                        const response = await fetch(`config/languages/${lang}.json`);
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                        }
                        this.languages[lang] = await response.json();
                        console.log(`‚úÖ Loaded ${lang} config`);
                    } catch (e) {
                        console.error(`‚ùå Failed to load ${lang} config:`, e);
                    }
                }
                console.log('Language configurations loaded:', Object.keys(this.languages));
            }
            
            setupEventListeners() {
                // Language selector buttons
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const lang = e.target.dataset.lang;
                        this.switchLanguage(lang);
                    });
                });
            }
            
            async switchLanguage(language) {
                if (language === this.currentLanguage) return;
                
                // TEMPORARY: Only allow switching to en_GB
                if (language !== 'en_GB') {
                    console.log(`Language ${language} is temporarily disabled`);
                    return;
                }
                
                // Redirect to en_GB page
                window.location.href = '/en_GB/';
                return;
            }
            
            updateLanguageSelector() {
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.lang === this.currentLanguage);
                });
            }
            
            async loadContent(language) {
                const loading = document.getElementById('loading');
                const container = document.getElementById('content-container');
                
                // Show loading
                loading.style.display = 'block';
                container.innerHTML = '';
                
                try {
                    // Load content from cache or fetch
                    let content = this.contentCache[language];
                    if (!content) {
                        content = await this.fetchContent(language);
                        this.contentCache[language] = content;
                    }
                    
                    // Update page metadata
                    this.updatePageMetadata(language);
                    
                    // Render content
                    container.innerHTML = content;
                    
                    // Initialize audio player and other interactive elements
                    this.initializeInteractiveElements();
                    
                } catch (e) {
                    console.error('Failed to load content:', e);
                    container.innerHTML = `
                        <div class="container">
                            <div class="error-message">
                                <h2>‚ö†Ô∏è Content Loading Error</h2>
                                <p>Unable to load content for this language. Please try again later.</p>
                                <button onclick="location.reload()" class="action-button">Reload Page</button>
                            </div>
                        </div>
                    `;
                } finally {
                    loading.style.display = 'none';
                }
            }
            
            async fetchContent(language) {
                // Try to load from language-specific directory first
                const paths = [
                    `${language}/content.html`,
                    `config/content/${language}.html`
                ];
                
                for (const path of paths) {
                    try {
                        const response = await fetch(path);
                        if (response.ok) {
                            return await response.text();
                        }
                    } catch (e) {
                        continue;
                    }
                }
                
                // Fallback: generate content dynamically
                return this.generateContent(language);
            }
            
            generateContent(language) {
                const config = this.languages[language];
                if (!config) {
                    console.error(`No configuration found for ${language}. Available languages:`, Object.keys(this.languages));
                    throw new Error(`No configuration found for ${language}`);
                }
                
                const today = new Date().toISOString().split('T')[0].replace(/-/g, '_');
                const audioFile = `${language}/audio/news_digest_ai_${today}.mp3`;
                
                // Check if this is a new language without content yet
                const isNewLanguage = !['en_GB', 'fr_FR', 'de_DE'].includes(language);
                if (isNewLanguage) {
                    return this.generateComingSoonContent(config, language);
                }
                
                return `
                    <!-- Today's audio digest -->
                    <section id="todays-digest" class="featured-digest" aria-labelledby="todays-heading">
                        <header class="section-header">
                            <h2 id="todays-heading" class="section-title">
                                <span class="section-icon" aria-hidden="true">üéß</span>
                                ${config.sections.todays_digest.title}
                            </h2>
                            <p class="section-description">${config.sections.todays_digest.description}</p>
                        </header>
                        
                        <article class="digest-card main-digest">
                            <header class="digest-header">
                                <h3 class="digest-title">
                                    <time datetime="${today.replace(/_/g, '-')}" class="digest-date">${this.formatDate(today, language)}</time>
                                    - ${config.site.name} Summary
                                </h3>
                            </header>
                            
                            <!-- Accessible audio player -->
                            <div class="audio-player-container">
                                <audio 
                                    class="audio-player" 
                                    controls 
                                    preload="auto"
                                    crossorigin="anonymous"
                                    aria-describedby="audio-description"
                                    id="news-audio"
                                >
                                    <source src="${audioFile}" type="audio/mpeg">
                                    ${config.audio.fallback.replace('{{AUDIO_FILE}}', audioFile)}
                                </audio>
                                
                                <p id="audio-description" class="audio-description">
                                    ${config.audio.description}
                                </p>
                            </div>
                            
                            <!-- Download and sharing options -->
                            <div class="digest-actions">
                                <a href="${audioFile}" 
                                   download="news_digest_ai_${today}.mp3" 
                                   class="action-btn download-btn"
                                   aria-describedby="download-help">
                                    <span class="btn-icon" aria-hidden="true">üì±</span>
                                    ${config.audio.download_button}
                                </a>
                                
                                <button id="copy-share-link" 
                                        class="action-btn share-btn"
                                        aria-describedby="share-help">
                                    <span class="btn-icon" aria-hidden="true">üîó</span>
                                    ${config.audio.share_button}
                                </button>
                            </div>
                            
                            <!-- Help text with better formatting -->
                            <div class="digest-help">
                                <div class="help-item" id="download-help">
                                    <h4 class="help-title">
                                        <span class="help-icon" aria-hidden="true">üì±</span>
                                        ${config.audio.download_button}
                                    </h4>
                                    <p class="help-description">${config.audio.download_help}</p>
                                </div>
                                
                                <div class="help-item" id="share-help">
                                    <h4 class="help-title">
                                        <span class="help-icon" aria-hidden="true">üîó</span>
                                        ${config.audio.share_button}
                                    </h4>
                                    <p class="help-description">${config.audio.share_help}</p>
                                </div>
                            </div>
                        </article>
                    </section>
                    
                    <!-- About this service -->
                    <section id="about-service" class="about-service" aria-labelledby="about-heading">
                        <header class="section-header">
                            <h2 id="about-heading" class="section-title">
                                <span class="section-icon" aria-hidden="true">üí°</span>
                                ${config.sections.about.title}
                            </h2>
                        </header>
                        
                        <div class="instructions">
                            <div class="instruction-group">
                                <h3 class="instruction-title">${config.about_content.what_you_get.title}</h3>
                                <ul class="instruction-list">
                                    ${config.about_content.what_you_get.items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="instruction-group">
                                <h3 class="instruction-title">${config.about_content.accessibility.title}</h3>
                                <ul class="instruction-list">
                                    ${config.about_content.accessibility.items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="instruction-group">
                                <h3 class="instruction-title">${config.about_content.contact.title}</h3>
                                <ul class="instruction-list">
                                    ${config.about_content.contact.items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            
                        </div>
                    </section>
                `;
            }
            
            updatePageMetadata(language) {
                const config = this.languages[language];
                if (!config) return;
                
                // Update page title
                document.title = config.page.title.replace('{{DATE}}', this.formatDate(new Date().toISOString().split('T')[0], language));
                
                // Update meta description
                const metaDesc = document.querySelector('meta[name="description"]');
                if (metaDesc) {
                    metaDesc.content = config.page.description.replace('{{DATE}}', this.formatDate(new Date().toISOString().split('T')[0], language));
                }
                
                // Update header
                document.getElementById('site-flag').textContent = config.site.flag;
                document.getElementById('site-name').textContent = config.site.name;
                document.getElementById('site-tagline').textContent = config.site.tagline;
                
                // Update footer
                document.getElementById('footer-text').innerHTML = config.footer.copyright;
                
                // Update HTML lang attribute
                document.documentElement.lang = config.language_code;
            }
            
            formatDate(dateStr, language) {
                // dateStr is in format YYYY_MM_DD, convert to YYYY-MM-DD for Date constructor
                const isoDateStr = dateStr.replace(/_/g, '-');
                const date = new Date(isoDateStr + 'T00:00:00');
                
                // Handle city-level locales by using base language
                const baseLanguage = language.split('_')[0] + '_' + language.split('_')[1];
                
                if (baseLanguage === 'en_GB') {
                    return date.toLocaleDateString('en-GB', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                } else if (baseLanguage === 'fr_FR') {
                    return date.toLocaleDateString('fr-FR', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                } else if (baseLanguage === 'de_DE') {
                    return date.toLocaleDateString('de-DE', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                }
                
                return dateStr;
            }
            
            generateComingSoonContent(config, language) {
                const today = new Date().toISOString().split('T')[0].replace(/-/g, '_');
                
                // Language-specific coming soon messages
                const comingSoonMessages = {
                    'es_ES': {
                        title: 'Generaci√≥n de Contenido en Progreso',
                        message1: `Estamos generando tu primer resumen de ${config.site.name}. Esto suele tardar unos minutos.`,
                        message2: '¬°Vuelve pronto para tu resumen de noticias personalizado!',
                        refreshButton: 'Actualizar P√°gina',
                        comingSoon: 'Pr√≥ximamente'
                    },
                    'it_IT': {
                        title: 'Generazione Contenuti in Corso',
                        message1: `Stiamo generando il tuo primo riassunto di ${config.site.name}. Di solito ci vogliono alcuni minuti.`,
                        message2: 'Torna presto per il tuo riassunto personalizzato delle notizie!',
                        refreshButton: 'Aggiorna Pagina',
                        comingSoon: 'Prossimamente'
                    },
                    'nl_NL': {
                        title: 'Inhoud Generatie Bezig',
                        message1: `We genereren je eerste ${config.site.name} samenvatting. Dit duurt meestal een paar minuten.`,
                        message2: 'Kom binnenkort terug voor je gepersonaliseerde nieuwssamenvatting!',
                        refreshButton: 'Pagina Vernieuwen',
                        comingSoon: 'Binnenkort Beschikbaar'
                    },
                    'en_GB_LON': {
                        title: 'Content Generation in Progress',
                        message1: `We're currently generating your first ${config.site.name} digest. This usually takes a few minutes.`,
                        message2: 'Please check back shortly for your personalized London news digest!',
                        refreshButton: 'Refresh Page',
                        comingSoon: 'Coming Soon'
                    },
                    'en_GB_LIV': {
                        title: 'Content Generation in Progress',
                        message1: `We're currently generating your first ${config.site.name} digest. This usually takes a few minutes.`,
                        message2: 'Please check back shortly for your personalized Liverpool news digest!',
                        refreshButton: 'Refresh Page',
                        comingSoon: 'Coming Soon'
                    }
                };
                
                const messages = comingSoonMessages[language] || comingSoonMessages['en_GB_LON'];
                
                return `
                    <!-- Coming Soon Message -->
                    <section id="coming-soon" class="featured-digest" aria-labelledby="coming-soon-heading">
                        <header class="section-header">
                            <h2 id="coming-soon-heading" class="section-title">
                                <span class="section-icon" aria-hidden="true">${config.site.flag}</span>
                                ${config.site.name}
                            </h2>
                            <p class="section-description">${config.sections.todays_digest.description}</p>
                        </header>
                        
                        <article class="digest-card main-digest">
                            <header class="digest-header">
                                <h3 class="digest-title">
                                    <time datetime="${today.replace(/_/g, '-')}" class="digest-date">${this.formatDate(today, language)}</time>
                                    - ${messages.comingSoon}
                                </h3>
                            </header>
                            
                            <div class="coming-soon-message">
                                <div class="status-icon">üöÄ</div>
                                <h4>${messages.title}</h4>
                                <p>${messages.message1}</p>
                                <p>${messages.message2}</p>
                                
                                <div class="refresh-actions">
                                    <button onclick="location.reload()" class="action-btn refresh-btn">
                                        <span class="btn-icon" aria-hidden="true">üîÑ</span>
                                        ${messages.refreshButton}
                                    </button>
                                </div>
                            </div>
                        </article>
                    </section>
                    
                    <!-- About this service -->
                    <section id="about-service" class="about-service" aria-labelledby="about-heading">
                        <header class="section-header">
                            <h2 id="about-heading" class="section-title">
                                <span class="section-icon" aria-hidden="true">üí°</span>
                                ${config.sections.about.title}
                            </h2>
                        </header>
                        
                        <div class="instructions">
                            <div class="instruction-group">
                                <h3 class="instruction-title">${config.about_content.what_you_get.title}</h3>
                                <ul class="instruction-list">
                                    ${config.about_content.what_you_get.items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="instruction-group">
                                <h3 class="instruction-title">${config.about_content.accessibility.title}</h3>
                                <ul class="instruction-list">
                                    ${config.about_content.accessibility.items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="instruction-group">
                                <h3 class="instruction-title">${config.about_content.contact.title}</h3>
                                <ul class="instruction-list">
                                    ${config.about_content.contact.items.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    </section>
                `;
            }
            
            isLondonPostalCode(postal) {
                if (!postal) return false;
                
                // London postal code patterns
                const londonCodes = [
                    // Central London
                    'W1', 'WC1', 'WC2', 'EC1', 'EC2', 'EC3', 'EC4',
                    // West London  
                    'W2', 'W3', 'W4', 'W5', 'W6', 'W7', 'W8', 'W9', 'W10', 'W11', 'W12', 'W13', 'W14',
                    // South West London
                    'SW1', 'SW2', 'SW3', 'SW4', 'SW5', 'SW6', 'SW7', 'SW8', 'SW9', 'SW10', 'SW11', 'SW12', 'SW13', 'SW14', 'SW15', 'SW16', 'SW17', 'SW18', 'SW19', 'SW20',
                    // South East London
                    'SE1', 'SE2', 'SE3', 'SE4', 'SE5', 'SE6', 'SE7', 'SE8', 'SE9', 'SE10', 'SE11', 'SE12', 'SE13', 'SE14', 'SE15', 'SE16', 'SE17', 'SE18', 'SE19', 'SE20', 'SE21', 'SE22', 'SE23', 'SE24', 'SE25', 'SE26', 'SE27', 'SE28',
                    // East London
                    'E1', 'E2', 'E3', 'E4', 'E5', 'E6', 'E7', 'E8', 'E9', 'E10', 'E11', 'E12', 'E13', 'E14', 'E15', 'E16', 'E17', 'E18', 'E20',
                    // North London
                    'N1', 'N2', 'N3', 'N4', 'N5', 'N6', 'N7', 'N8', 'N9', 'N10', 'N11', 'N12', 'N13', 'N14', 'N15', 'N16', 'N17', 'N18', 'N19', 'N20', 'N21', 'N22',
                    // North West London
                    'NW1', 'NW2', 'NW3', 'NW4', 'NW5', 'NW6', 'NW7', 'NW8', 'NW9', 'NW10', 'NW11'
                ];
                
                // Check if postal code starts with any London pattern
                return londonCodes.some(code => postal.toUpperCase().startsWith(code));
            }
            
            isLiverpoolPostalCode(postal) {
                if (!postal) return false;
                
                // Liverpool postal code patterns
                const liverpoolCodes = [
                    'L1', 'L2', 'L3', 'L4', 'L5', 'L6', 'L7', 'L8', 'L9', 'L10',
                    'L11', 'L12', 'L13', 'L14', 'L15', 'L16', 'L17', 'L18', 'L19', 'L20',
                    'L21', 'L22', 'L23', 'L24', 'L25', 'L26', 'L27', 'L28', 'L29', 'L30',
                    'L31', 'L32', 'L33', 'L34', 'L35', 'L36', 'L37', 'L38', 'L39', 'L40'
                ];
                
                // Check if postal code starts with any Liverpool pattern
                return liverpoolCodes.some(code => postal.toUpperCase().startsWith(code));
            }
            
            initializeInteractiveElements() {
                // Copy to clipboard functionality
                const copyButton = document.getElementById('copy-share-link');
                if (copyButton) {
                    copyButton.addEventListener('click', async () => {
                        const config = this.languages[this.currentLanguage];
                        const shareUrl = window.location.origin + window.location.pathname + '?autoplay=1&lang=' + this.currentLanguage;
                        
                        try {
                            await navigator.clipboard.writeText(shareUrl);
                            
                            const originalText = copyButton.textContent;
                            copyButton.textContent = '‚úÖ ' + config.javascript.copy_success;
                            copyButton.style.background = '#48bb78';
                            
                            setTimeout(() => {
                                copyButton.textContent = originalText;
                                copyButton.style.background = '';
                            }, 2000);
                            
                        } catch (err) {
                            alert(config.javascript.copy_error + shareUrl);
                        }
                    });
                }
                
                // Auto-play functionality
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('autoplay') === '1') {
                    const audioElement = document.getElementById('news-audio');
                    if (audioElement) {
                        setTimeout(() => {
                            audioElement.play().catch(e => {
                                console.log('Auto-play prevented by browser policy');
                            });
                        }, 500);
                    }
                }
            }
        }
        
        // Initialize app when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            new AudioNewsApp();
        });
    </script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js')
                    .then(function(registration) {
                        console.log('‚úÖ ServiceWorker registered successfully:', registration.scope);
                    }, function(err) {
                        console.log('‚ùå ServiceWorker registration failed:', err);
                    });
            });
        }
    </script>
</body>
</html>